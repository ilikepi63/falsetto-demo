"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createPreparedStatement = exports.createColumnList = exports.createInsertStatement = void 0;
const utils_1 = require("./utils");
const INSERT_INTO = "INSERT INTO";
const VALUES = "VALUES";
const createInsertStatement = (query) => `${INSERT_INTO} ${utils_1.createNameFromQuery(query)} ${exports.createColumnList(query)} ${VALUES} ${exports.createPreparedStatement(query)};`;
exports.createInsertStatement = createInsertStatement;
const createColumnList = (query) => utils_1.parenthesis(`${Object.entries(query.schema.attributes).map(([, attribute]) => attribute.name).join(", ")}`);
exports.createColumnList = createColumnList;
const createPreparedStatement = (query) => {
    let statement = "";
    for (const [index, [, value]] of Object.entries(query.schema.attributes).entries()) {
        let addition = "?";
        if (!(index === (Object.keys(query.schema.attributes).length - 1)))
            addition = addition + ", ";
        statement = statement + addition;
    }
    return utils_1.parenthesis(statement);
};
exports.createPreparedStatement = createPreparedStatement;
